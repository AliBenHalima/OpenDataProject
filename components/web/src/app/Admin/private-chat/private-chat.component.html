<div *ngFor="let item of feeds">
  <p>feed is {{item}}</p>
</div>
<p>P</p>



<app-header></app-header>
<div class="container-fluid sb2">
  <div class="row">
    <app-sidebar></app-sidebar>
<div class="sb2-2">
  <div class="sb2-2-2">
      <ul>
          <li><a href="#"><i class="fa fa-home" aria-hidden="true"></i> Home</a>
          </li>
          <li class="active-bre"><a href="#"> Chats</a>
          </li>
      </ul>
  </div>
  <div class="sb2-2-3">
      <div class="row">
        <div class="container">
          <div class="ks-page-content">
              <div class="ks-page-content-body">
                  <div class="ks-messenger">
                      <div class="ks-discussions">
                          <div class="ks-search">
                              <div class="input-icon icon-right icon icon-lg icon-color-primary">
                                <input   [(ngModel)]="searchText"  (input)="onSearchChange(searchText)" id="input-group-icon-text" type="text" class="form-control" placeholder="Search">                                  <span class="icon-addon">
                          <span class="la la-search"></span>
                                  </span>
                              </div>
                          </div>
                          <div   class="ks-body ks-scrollable jspScrollable" data-auto-height="" style="height: 400px; overflow-y: auto; padding: 0px; width: 339px;" tabindex="0">

                              <div class="jspContainer" style="width: 339px; height: auto;">
                                  <div class="jspPane" style="padding: 0px; top: 0px; width: 329px;">
                                    <p-inputSwitch [(ngModel)]="checked" (onChange)="ToggleOnline($event)"></p-inputSwitch>

                                      <ul class="ks-items" *ngFor="let user of users" >
                   <li  [ngClass]="user.count > 0 ? 'ks-item  ks-active' : 'ks-item'"  *ngIf="user.id != user_id" (click)="fetchPrivateMsg(user)">

                                          <a >
                                            <!-- <span *ngIf="user.count > 0" class="ks-group-amount">{{user.count}}</span> -->
                                            <!-- <span *ngIf="user.count > 0" matBadge={{user.count}}>
                                            </span> -->
                                              <span class="ks-avatar">
                                                <div class="ring-container" *ngIf="CheckOnline(user.id)" >
                                                  <div class="ringring"></div>
                                                  <div class="circle"></div>
                                              </div>

                                              <img  [src]='environment+"/storage/images/Users/"+user.photo' width="36" height="36">

                                                  <span *ngIf="user.count > 0" matBadge={{user.count}}>
                                                  </span>
                                                  </span>



                                              <div class="ks-body">
                                                  <div  [ngClass]="user.id == CurrentFriend.id ? 'ks-name text-primary' : 'ks-name'">
                                                    <!-- <p *ngIf="OnlineMembers.find(e=>e.id==user.id"> Active</p> -->
                                                      {{user.name}}
                                                      <span *ngIf="user.newmsgDate != '' "  class="ks-datetime">{{user.newmsgDate | date:'shortTime'}}</span>
                                                  </div>
                                                  <div  *ngIf="user.newmsg != '' " class="ks-message font-weight-bold">{{user.newmsg}}</div>
                                              </div>
                                          </a>
                                      </li>
                                          <!-- <li class="ks-item ks-active">
                                              <a href="#">
                                                  <span class="ks-group-amount">3</span>
                                                  <div class="ks-body">
                                                      <div class="ks-name">
                                                          Group Chat
                                                          <span class="ks-datetime">just now</span>
                                                      </div>
                                                      <div class="ks-message">
                                                          <img src="https://bootdey.com/img/Content/avatar/avatar1.png" width="18" height="18" class="rounded-circle"> The weird future of movie theater food
                                                      </div>
                                                  </div>
                                              </a>
                                          </li>
                                          <li class="ks-item ks-unread">
                                              <a href="#">
                                                  <span class="ks-group-amount">5</span>
                                                  <div class="ks-body">
                                                      <div class="ks-name">
                                                          Eric George
                                                          <span class="ks-datetime">just now</span>
                                                      </div>
                                                      <div class="ks-message">
                                                          <img src="https://bootdey.com/img/Content/avatar/avatar2.png" width="18" height="18" class="rounded-circle"> Why didn't he come and talk to me...
                                                      </div>
                                                  </div>
                                              </a>
                                          </li> -->

                                         </ul>
                                     </div>
                                  <!-- <div class="jspVerticalBar">
                                      <div class="jspCap jspCapTop"></div>
                                      <div class="jspTrack" style="height: 550px;">
                                          <div class="jspDrag" style="height: 261px;">
                                              <div class="jspDragTop"></div>
                                              <div class="jspDragBottom"></div>
                                          </div>
                                      </div>
                                      <div class="jspCap jspCapBottom"></div>
                                  </div> -->
                              </div>
                          </div>
                          <!-- //////////////// -->
                       <!--   <div class="ks-search">
                            <div class="input-icon icon-right icon icon-lg icon-color-primary">
                              <button  (click)="openNew()" pButton pRipple label="New"  icon="pi pi-plus" class="p-button-success p-mr-2"  ></button>
                                <input id="input-group-icon-text" type="text" class="form-control" placeholder="Search">

                                <span class="icon-addon">
                        <span class="la la-search"></span>
                                </span>
                            </div>
                        </div> -->
                        <div *ngFor="let sujet of sujets">
                          <p (click)="setSujet(CurrentSujet,sujet)">{{sujet.name}} </p> <i (click)="DeleteSujet(sujet.id)" class="pi pi-trash"></i>
                        </div>


                      </div>

                  <!--    <p-sidebar [style]="{width:'22em'}" [(visible)]="visibleSidebar2" position="right" [baseZIndex]="10000">
                        <h1 style="font-weight:normal">Users</h1>

                          <div class="jspPane" style="padding: 0px; top: 0px; width: 329px;">
                          <ul class="ks-items" *ngFor="let user of users">
                            <li class="ks-item" *ngIf="user.id != user_id" (click)="fetchPrivateMsg(user)">

                              <a>

                                  <span  class="ks-avatar">
                                      <img  [src]='"http://127.0.0.1:8000/storage/images/Users/"+user.photo' width="36" height="36">
                                  </span>
                                  <span *ngIf="user.count > 0" matBadge={{user.count}}>
                                  </span>
                                  <div class="ks-body">

                                      <div  [ngClass]="user.id == CurrentFriend.id ? 'ks-name text-success' : 'ks-name'">
                                          {{user.name}} {{notification.count}}

                                      </div>

                                  </div>
                              </a>
                          </li>
                          </ul>
                        </div>

                    </p-sidebar> -->



                      <div class="ks-messages ks-messenger__messages">
                          <div class="ks-header">
                              <div class="ks-description">
                                  <div class="ks-name">{{CurrentFriend.name}}</div>
                                  <!-- <div class="ks-amount">2 members</div> -->
                              </div>
                              <div class="ks-controls">
                                <p-button type="button" (click)="visibleSidebar2 = true" icon="pi pi-arrow-left"></p-button>

                              </div>
                          </div>
                          <div  id="mychatelement1" class="ks-body ks-scrollable jspScrollable" data-auto-height="" data-reduce-height=".ks-footer" data-fix-height="32" style="height: 100%; overflow-y: scroll; padding: 0px; width: auto;" tabindex="0">
                              <div class="jspContainer" style="width: 701px; height: 481px;">
                                  <div class="jspPane" style="padding: 0px; top: 0px; width: 691px;">
                                    <!-- ////////////////////////////// -->
                                    <ul class="ks-items" *ngFor="let msg of messages">
                                      <!--   <div> Start a New Conversation</div>-->
                                      <li [ngClass]="msg.users.id == user_id ? 'ks-item ks-from' : 'ks-item ks-self'">

                                          <!-- <li  class="ks-item ks-from"> -->
                                              <span class="ks-avatar ks-offline">
                                                <img  [src]='environment+"/storage/images/Users/"+msg.users.photo' width="36" height="36" class="rounded-circle">
                                              </span>

                                              <div class="ks-body">
                                                  <div class="ks-header">
                                                      <span class="ks-name">{{msg.users.name}}</span>
                                                      <span class="ks-datetime">{{msg.created_at | date:'medium'}}</span>
                                                  </div>

                                                  <div class="ks-self">{{msg.contenu}}</div>
                                              </div>
                                          </li>
                                                      <!-- ////// -->
                                          <!-- <li class="ks-item ks-from ks-unread">
                                              <span class="ks-avatar ks-online">
                                                  <img src="https://bootdey.com/img/Content/avatar/avatar5.png" width="36" height="36" class="rounded-circle">
                                              </span>
                                              <div class="ks-body">
                                                  <div class="ks-header">
                                                      <span class="ks-name">Brian Diaz</span>
                                                      <span class="ks-datetime">1 minute ago</span>
                                                  </div>
                                                  <div class="ks-message">
                                                      The weird future of movie theater food

                                                  </div>
                                              </div>
                                          </li> -->


                                      </ul>
                                  </div>
                                  <!-- <div class="jspVerticalBar">
                                      <div class="jspCap jspCapTop"></div>
                                      <div class="jspTrack" style="height: 481px;">
                                          <div class="jspDrag" style="height: 206px;">
                                              <div class="jspDragTop"></div>
                                              <div class="jspDragBottom"></div>
                                          </div>
                                      </div>
                                      <div class="jspCap jspCapBottom"></div>
                                  </div> -->
                              </div>
                          </div>
                          <div class="ks-footer">
                              <textarea class="form-control" placeholder="Type something..." [(ngModel)]="message"></textarea>
                              <div class="ks-controls">
                                  <button (click)="SendMessage()" class="btn btn-primary" >Send</button>
                                  <a href="#" class="la la-paperclip ks-attachment"></a>
                                  <div class="dropdown dropup">
                                      <button class="btn btn-link ks-smile" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          <span class="la la-smile-o"></span>
                                      </button>

                                  </div>
                              </div>
                          </div>
                      </div>

                  </div>
              </div>
          </div>
          </div>







      </div>
  </div>
</div>

</div>
</div>
<p-toast [style]="{marginTop: '80px'}"></p-toast>
<p-confirmDialog header="Confirmation" icon="pi pi-exclamation-triangle"></p-confirmDialog>


<p-dialog [contentStyle]="{'overflow':'visible'}" [(visible)]="displayModal" [style]="{width: '650px',height: '250px'}" header="Add Sujets" [modal]="true" styleClass="p-fluid" (onHide)="hideDialog()">


  <ng-template pTemplate="content" [style]="{'width':'100%'}">
    <form  [formGroup]="form">
    <div class="p-fluid p-formgrid p-grid">
      <div class="p-field p-col-12 p-md-6">
          <label for="name" ><h5>name</h5></label>
          <input formControlName="name" id="Name" type="text" pInputText>
      </div>

  </div>
</form>

</ng-template>
<p-footer>
  <button pButton pRipple label="Cancel" icon="pi pi-times" class="p-button-text" (click)="hideDialog()"></button>
  <button  pButton pRipple label="Save" icon="pi pi-check" class="p-button-text" (click)="HandleForm()"></button>
  <!-- <button *ngIf="update" pButton pRipple label="Update" icon="pi pi-check" class="p-button-text" (click)="updateRole()"></button> -->

</p-footer>


<!-- </div> -->
</p-dialog>
